<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>mouse move</title>
	</head>
	<script type="text/javascript" src="../sea.js"></script>
	<script type="text/javascript" src="dest/trajectory.js"></script>
	<body>
		
	</body>
	<script type="text/javascript">

		seajs.use([ "trajectory/atom",
					"trajectory/line",
					"trajectory/util/cpi",
					"trajectory/util/looper",
					"trajectory/util/random"
					],
			function(Atom,Line,cpi,looper,random){
				var canvas = cpi.createCanvasFullScreen(),
					ctx = canvas.getContext('2d'),
					line = new Line(),
					i=0,atoms = [];

				for(;i<2000;i++){
					var atom = new Atom({x:random(0,canvas.width),y:random(0,canvas.height)});
					atoms.push(atom);
				}
				// motion.setAtoms(atoms);
				line.addAtom(atoms);
				canvas.onmousemove=function(e){
					line.emit('mouseover',e.x,e.y);
				};
				canvas.onmousedown = function(e){
					line.random(0,0,canvas.width,canvas.height);
				};

				line.on('mouseover',function(x,y){
					var atoms = this.atoms;
					for(var i = 0;i<atoms.length;i++){
						atoms[i].set('vel',random(1,100));
						atoms[i].set("destination",{x:x,y:y});
					}
				});

				looper.add([
					function(){
						ctx.clearRect(0,0,canvas.width,canvas.height);
					},function(){
						line.next();
						line.renderTo(canvas);
				}]);
				looper.run();
		});
	</script>
	
</html>